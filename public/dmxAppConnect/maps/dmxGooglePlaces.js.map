{"version":3,"sources":["components/googleAutocomplete.js","components/googlePlacesSearch.js"],"names":["dmx","Component","extends","initialData","placeId","address","phone","phone2","latitude","longitude","icon","name","priceLevel","rating","types","url","utcOffset","vicinity","website","attributes","map","type","String","default","country","Boolean","render","node","BaseComponent","prototype","call","this","$node","value","props","disabled","defaultValue","set","target","document","getElementById","dmxComponent","autocomplete","google","maps","places","Autocomplete","strictBounds","split","bindTo","setComponentRestrictions","addListener","onchange","bind","update","setOptions","setTypes","place","getPlace","place_id","formatted_address","formatted_phone_number","international_phone_number","geometry","location","lat","lng","attributions","html_attributions","isOpen","opening_hours","price_level","userRatingsTotal","user_ratings_total","utc_offset_minutes","adrAddress","adr_address","components","Array","isArray","address_components","reduce","output","component","forEach","replace","m","c","toUpperCase","long","long_name","short","short_name","viewport","fitBounds","setCenter","setZoom","setTimeout","dispatchEvent","results","hasMore","status","fields","methods","findPlaceFromQuery","params","request","clearMarkers","query","bindBounds","locationBias","getBounds","radius","center","PlacesService","onresults","findPlaceFromPhoneNumber","phoneNumber","nearby","bounds","keyword","openNow","nearbySearch","search","textSearch","getMore","pagination","hasNextPage","nextPage","markers","cluster","marker","setMap","image","size","Size","origin","Point","anchor","scaledSize","Marker","title","position","addMarker","push","console","warn"],"mappings":"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","file":"../dmxGooglePlaces/dmxGooglePlaces.js","sourcesContent":["dmx.Component('google-autocomplete', {\r\n\r\n    extends: 'input',\r\n\r\n    initialData:{\r\n        placeId: null,\r\n        address: null,\r\n        phone: null,\r\n        phone2: null,\r\n        latitude: null,\r\n        longitude: null,\r\n        icon: null,\r\n        name: null,\r\n        priceLevel: null,\r\n        rating: null,\r\n        types: null,\r\n        url: null,\r\n        utcOffset: null, // in minutes\r\n        vicinity: null,\r\n        website: null\r\n    },\r\n\r\n    attributes: {\r\n        map: {\r\n            type: String,\r\n            default: null\r\n        },\r\n\r\n        country: { // restrict to country (ISO 3166-1 Alpha-2 country code) (up to 5 max, separate with comma)\r\n            type: String,\r\n            default: null\r\n        },\r\n\r\n        types: {\r\n            type: String,\r\n            default: null // geocode, address, establishment, (regions), (cities)\r\n        },\r\n\r\n        'strict-bounds': {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n\r\n        'move-map': {\r\n            type: Boolean,\r\n            default: false\r\n        }\r\n    },\r\n\r\n    render: function(node) {\r\n        dmx.BaseComponent.prototype.render.call(this, node);\r\n        this.$node.value = this.props.value;\r\n        this.$node.disabled = this.props.disabled;\r\n        this.$node.defaultValue = this.props.value;\r\n        this.set('value', this.props.value);\r\n        this.set('disabled', this.props.disabled);\r\n\r\n        this.target = document.getElementById(this.props.map);\r\n        this.map = this.target && this.target.dmxComponent && this.target.dmxComponent.map;\r\n\r\n        this.autocomplete = new google.maps.places.Autocomplete(this.$node, {\r\n            strictBounds: this.props['strict-bounds'],\r\n            types: this.props.types ? this.props.types.split(/\\s*,\\s*/) : [],\r\n        });\r\n\r\n        if (this.map) {\r\n            this.autocomplete.bindTo('bounds', this.map);\r\n        }\r\n\r\n        if (this.props.country) {\r\n            this.autocomplete.setComponentRestrictions({country: this.props.country.split(/\\s*,\\s*/)});\r\n        }\r\n\r\n        this.autocomplete.addListener('place_changed', this.onchange.bind(this));\r\n    },\r\n\r\n    update: function(props) {\r\n        if (this.props.map && !this.map) {\r\n            this.map = this.target && this.target.dmxComponent && this.target.dmxComponent.map;\r\n            this.autocomplete.bindTo('bounds', this.map);\r\n        }\r\n\r\n        if (props['strict-bounds'] != this.props['strict-bounds']) {\r\n            this.autocomplete.setOptions({ strictBounds: this.props['strict-bounds'] });\r\n        }\r\n\r\n        if (props.types != this.props.types) {\r\n            //this.autocomplete.setOptions({ types: this.props.types });\r\n            this.autocomplete.setTypes(this.props.types);\r\n        }\r\n\r\n        if (props.country != this.props.country) {\r\n            this.autocomplete.setComponentRestrictions({country: this.props.country ? this.props.country.split(/\\s*,\\s*/) : []});\r\n        }\r\n\r\n        if (props.disabled != this.props.disabled) {\r\n            this.$node.disabled = this.props.disabled;\r\n        }\r\n    },\r\n\r\n    onchange: function() {\r\n        var place = this.autocomplete.getPlace();\r\n        if (!place.place_id) return;\r\n\r\n        this.set('value', this.$node.value);\r\n        this.set({\r\n            placeId: place.place_id,\r\n            address: place.formatted_address,\r\n            phone: place.formatted_phone_number,\r\n            phone2: place.international_phone_number,\r\n            latitude: place.geometry && place.geometry.location.lat(),\r\n            longitude: place.geometry && place.geometry.location.lng(),\r\n            attributions: place.html_attributions,\r\n            icon: place.icon,\r\n            name: place.name,\r\n            isOpen: place.opening_hours && place.opening_hours.isOpen(),\r\n            priceLevel: place.price_level,\r\n            rating: place.rating,\r\n            types: place.types,\r\n            url: place.url,\r\n            userRatingsTotal: place.user_ratings_total,\r\n            utcOffset: place.utc_offset_minutes,\r\n            vicinity: place.vicinity,\r\n            website: place.website,\r\n            adrAddress: place.adr_address,\r\n            components: Array.isArray(place.address_components) ? place.address_components.reduce(function(output, component) {\r\n                component.types.forEach(function(type) {\r\n                    output[type.replace(/_(\\w)/g, function(m, c) { return c.toUpperCase() })] = {\r\n                        long: component.long_name,\r\n                        short: component.short_name\r\n                    }\r\n                });\r\n\r\n                return output;\r\n            }, {}) : null\r\n        });\r\n\r\n        if (this.props['move-map'] && this.map) {\r\n            if (place.geometry.viewport) {\r\n                this.map.fitBounds(place.geometry.viewport);\r\n            } else {\r\n                this.map.setCenter(place.geometry.location);\r\n                this.map.setZoom(17);\r\n            }\r\n        }\r\n\r\n        setTimeout(this.dispatchEvent.bind(this, 'updated'), 100);\r\n    }\r\n\r\n});\r\n","dmx.Component('google-places-search', {\r\n\r\n    initialData:{\r\n        results: [],\r\n        hasMore: false,\r\n        status: ''\r\n    },\r\n\r\n    attributes: {\r\n        map: {\r\n            type: String,\r\n            default: null\r\n        },\r\n\r\n        fields: { // https://developers.google.com/maps/documentation/javascript/places#place_search_fields\r\n            type: [Array, String],\r\n            default: ['place_id', 'business_status', 'formatted_address', 'geometry', 'icon', 'name', 'type']\r\n        },\r\n\r\n        'show-on-map': {\r\n            type: Boolean,\r\n            default: false\r\n        }\r\n    },\r\n\r\n    methods: {\r\n        findPlaceFromQuery: function(params) {\r\n            var request = {};\r\n            var fields = params.fields || this.props.fields;\r\n            \r\n            this.clearMarkers();\r\n\r\n            request.query = params.query;\r\n            request.fields = Array.isArray(fields) ? fields : fields.split(/\\s*,\\s*/);\r\n\r\n            if (params.bindBounds) {\r\n                request.locationBias = this.map.getBounds();\r\n            } else {\r\n                if (params.latitude && params.longitude) {\r\n                    if (params.radius) {\r\n                        request.locationBias = {\r\n                            center: { lat: +params.latitude, lng: +params.longitude },\r\n                            radius: +params.radius\r\n                        };\r\n                     } else {\r\n                        request.locationBias = { lat: +params.latitude, lng: +params.longitude };\r\n                    }\r\n                }\r\n            }\r\n\r\n            var service = new google.maps.places.PlacesService(this.map);\r\n            service.findPlaceFromQuery(request, this.onresults.bind(this));\r\n        },\r\n\r\n        findPlaceFromPhoneNumber: function(params) {\r\n            var request = {};\r\n            var fields = params.fields || this.props.fields;\r\n\r\n            this.clearMarkers();\r\n            \r\n            request.phoneNumber = params.phoneNumber;\r\n            request.fields = Array.isArray(fields) ? fields : fields.split(/\\s*,\\s*/);\r\n\r\n            if (params.bindBounds) {\r\n                request.locationBias = this.map.getBounds();\r\n            } else {\r\n                if (params.latitude && params.longitude) {\r\n                    if (params.radius) {\r\n                        request.locationBias = {\r\n                            center: { lat: +params.latitude, lng: +params.longitude },\r\n                            radius: +params.radius\r\n                        };\r\n                     } else {\r\n                        request.locationBias = { lat: +params.latitude, lng: +params.longitude };\r\n                    }\r\n                }\r\n            }\r\n\r\n            var service = new google.maps.places.PlacesService(this.map);\r\n            service.findPlaceFromPhoneNumber(request, this.onresults.bind(this));\r\n        },\r\n\r\n        nearby: function(params) {\r\n            var request = {};\r\n\r\n            this.clearMarkers();\r\n\r\n            if (params.latitude != null && params.longitude != null) {\r\n                request.location = { lat: +params.latitude, lng: +params.longitude };\r\n                request.radius = +params.radius || 500;\r\n            } else {\r\n                request.bounds = this.map.getBounds();\r\n            }\r\n\r\n            if (params.keyword) {\r\n                request.keyword = params.keyword;\r\n            }\r\n\r\n            if (params.name) {\r\n                request.name = params.name;\r\n            }\r\n\r\n            if (params.openNow) {\r\n                request.openNow = params.openNow;\r\n            }\r\n            \r\n            request.type = params.type;\r\n\r\n            var service = new google.maps.places.PlacesService(this.map);\r\n            service.nearbySearch(request, this.onresults.bind(this));\r\n        },\r\n\r\n        search: function(params) {\r\n            var request = {};\r\n\r\n            this.clearMarkers();\r\n\r\n            if (params.latitude != null && params.longitude != null) {\r\n                request.location = { lat: +params.latitude, lng: +params.longitude };\r\n                request.radius = +params.radius || 500;\r\n            } else {\r\n                request.bounds = this.map.getBounds();\r\n            }\r\n\r\n            if (params.openNow) {\r\n                request.openNow = params.openNow;\r\n            }\r\n\r\n            if (params.type) {\r\n                request.type = params.type;\r\n            }\r\n\r\n            request.query = params.query;\r\n\r\n            var service = new google.maps.places.PlacesService(this.map);\r\n            service.textSearch(request, this.onresults.bind(this));\r\n        },\r\n\r\n        getMore: function() {\r\n            if (this.pagination && this.pagination.hasNextPage) {\r\n                this.pagination.nextPage();\r\n            }\r\n        }\r\n    },\r\n\r\n    render: function(node) {\r\n        this.markers = [];\r\n        this.target = document.getElementById(this.props.map);\r\n        this.cluster = this.target && this.target.dmxComponent && this.target.dmxComponent.cluster;\r\n        this.map = this.target && this.target.dmxComponent && this.target.dmxComponent.map;\r\n    },\r\n\r\n    update: function(props) {\r\n        if (this.props.map && !this.map) {\r\n            this.cluster = this.target && this.target.dmxComponent && this.target.dmxComponent.cluster;\r\n            this.map = this.target && this.target.dmxComponent && this.target.dmxComponent.map;\r\n        }\r\n    },\r\n\r\n    clearMarkers: function() {\r\n        if (this.cluster) {\r\n            this.cluster.clearMarkers();\r\n        }\r\n\r\n        this.markers.forEach(function(marker) {\r\n            // remove from map\r\n            marker.setMap(null);\r\n        });\r\n\r\n        this.markers = [];\r\n    },\r\n\r\n    onresults: function(results, status, pagination) {\r\n        this.set('status', status);\r\n        this.set('hasMore', !!(pagination && pagination.hasNextPage));\r\n\r\n        this.pagination = pagination;\r\n\r\n        if (status == 'OK') {\r\n            this.set('results', results.map(function(place) {\r\n                return {\r\n                    placeId: place.place_id,\r\n                    address: place.formatted_address,\r\n                    latitude: place.geometry.location.lat(),\r\n                    longitude: place.geometry.location.lng(),\r\n                    icon: place.icon,\r\n                    name: place.name,\r\n                    types: place.types\r\n                }\r\n            }));\r\n\r\n            if (this.props['show-on-map']) {\r\n                // create markers on map\r\n                results.forEach(function(place) {\r\n                    var image = {\r\n                        url: place.icon,\r\n                        size: new google.maps.Size(71, 71),\r\n                        origin: new google.maps.Point(0, 0),\r\n                        anchor: new google.maps.Point(17, 34),\r\n                        scaledSize: new google.maps.Size(25, 25)\r\n                    };\r\n\r\n                    var marker = new google.maps.Marker({\r\n                        //map: this.map,\r\n                        icon: image,\r\n                        title: place.name,\r\n                        position: place.geometry.location\r\n                    });\r\n\r\n                    if (this.cluster) {\r\n                        this.cluster.addMarker(marker);\r\n                    } else {\r\n                        marker.setMap(this.map);\r\n                    }\r\n\r\n                    this.markers.push(marker);\r\n                }, this);\r\n            }\r\n        } else {\r\n            console.warn('Places search failed.', status);\r\n        }\r\n    }\r\n\r\n});\r\n"]}